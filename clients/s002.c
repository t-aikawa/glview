/*
 * glview sample
   Written by T.Aikawa. 2021/01/08
 */

#include "glview.h"

static char *image_c_source =
"\x89\x50\x4e\x47\x0d\x0a\x1a\x0a\x00\x00\x00\x0d\x49\x48\x44\x52\x00\x00\x00\x40\x00\x00\x00\x40\x08\x03\x00\x00\x00\x9d\xb7\x81"
"\xec\x00\x00\x02\xee\x50\x4c\x54\x45\x00\x00\x00\x09\x09\x09\x00\x00\x00\x00\x00\x00\x05\x05\x05\x00\x00\x00\x3e\x3e\x3e\xf1\xf1"
"\xf1\xd5\xd5\xd5\xe6\xe6\xe6\x09\x09\x09\x04\x04\x04\x00\x00\x00\x05\x05\x05\x04\x04\x04\x09\x09\x09\xfc\xf8\xf8\xcf\xcf\xcf\xd2"
"\xd2\xd2\xe5\xe5\xe5\x7c\x7c\x7c\x10\x10\x10\x5e\x5e\x5e\x00\x00\x00\x51\x51\x51\xf3\xf3\xf3\xf0\xf0\xf0\xa9\xa9\xa9\x49\x49\x49"
"\xb1\xb1\xb1\xc9\xc9\xc9\x79\x79\x79\x58\x58\x58\x5f\x5f\x5f\x4f\x4f\x4f\x23\x23\x23\xdc\xdc\xdc\xd6\xd6\xd6\xb5\xb5\xb5\x96\x96"
"\x96\x63\x63\x63\x8f\x8f\x8f\xa2\xa2\xa2\x77\x77\x77\xdb\xdb\xdb\xde\xde\xde\x71\x71\x71\x96\x96\x96\xff\xff\xff\x00\x00\x00\x80"
"\x80\x80\xf2\xf3\xf3\xb8\xb9\xb9\xff\x8d\xc5\xec\x69\xa3\x03\x06\x06\xef\x75\xac\xff\xff\xe0\x15\x17\x17\xd3\x4e\x30\xff\xc4\x00"
"\xbd\xfe\xff\xea\x5e\x9c\x6f\x6f\x79\x1d\x26\x26\xfc\xf7\xd8\xb0\xb1\xb4\x73\x76\x7a\x40\x2b\x3d\xff\x9f\x00\x0b\x0e\x0e\xd8\xff"
"\xff\xcd\xff\xff\xff\xff\xf6\xf3\xee\xcf\x96\x95\x94\x33\x44\x47\x14\x03\x02\xcb\xcb\xcc\x7c\x79\x79\x79\x74\x61\xfd\x5e\x3b\x28"
"\x37\x3a\xda\x50\x32\x3e\x1d\x2e\xa0\x73\x00\xc6\xff\xff\xfc\xfb\xfb\xff\x5a\xac\xf6\x57\x9e\x6e\x6c\x5e\x3a\x4a\x4f\x4b\x4c\x4a"
"\xf3\x59\x38\xeb\x56\x36\x3b\x14\x25\x71\x1f\x18\x2f\x39\x04\x9f\x69\x00\xeb\xff\xff\x9f\xdf\xe9\xd3\xd2\xd2\xeb\xe6\xc8\xfb\x67"
"\xaa\xdf\x6c\x6c\x7b\x7a\x6b\x3f\x3e\x3d\x36\x10\x05\xe0\xff\xff\xb4\xfa\xff\xff\xff\xe9\xe5\xe6\xe6\xd8\xd8\xd8\xf8\xd6\xd6\xa2"
"\xa3\xa5\x8d\x8b\x8c\xa3\x9f\x87\x58\x74\x78\x69\x6a\x6d\x43\x64\x68\x98\x32\x60\x74\x39\x36\x3a\x39\x30\x8a\x33\x23\x3c\x15\x12"
"\x4d\x1a\x0e\x34\x41\x03\xff\xa4\x00\xed\xcc\xcc\xe5\xe0\xc3\xf4\xc0\xc0\x76\x9c\xa2\xff\x50\xa2\xff\x77\x77\xbd\x35\x74\x72\x72"
"\x72\xf9\x6b\x6b\xff\x67\x67\x34\x54\x59\xfe\xff\x55\xe2\x53\x34\x59\x08\x2d\x35\x33\x2c\x21\x1f\x1f\x70\x28\x1c\xc3\xf5\xfc\xb1"
"\xee\xf8\xda\xda\xbf\xff\x5c\xb8\xd9\xd2\xb5\xff\x69\xb4\x9d\x9d\x9d\xeb\x53\x97\xb4\xab\x92\xdd\x48\x8a\x86\x86\x87\x82\x83\x83"
"\x63\x63\x5f\xff\x5c\x5c\x44\x51\x57\xe6\xc0\x4f\x72\x47\x40\x41\x53\x3f\xd7\x8b\x28\x29\x03\x13\x6d\x16\x0f\x29\x2a\x04\x21\x09"
"\x02\xff\xba\x00\x44\x1b\x00\xff\xea\xea\xae\xe0\xe8\xde\xde\xdf\xfe\xde\xde\xc0\xc0\xc0\xfc\xb2\xb2\xe9\xaf\xaf\xca\xc3\xa8\xf2"
"\x61\xa1\xb8\xb6\x9c\xf7\x9b\x9b\x60\x79\x83\x6d\x75\x81\x94\x8c\x7f\xec\x75\x75\xfa\x73\x73\x96\x4a\x6c\x51\x5d\x6b\xeb\x63\x63"
"\xdf\xe2\x62\xea\x5b\x5b\x5d\x5c\x57\x55\x55\x55\x75\x59\x52\xd0\x95\x4b\x84\x15\x4a\xc8\x75\x40\xca\x5e\x30\x31\x43\x30\x1f\x2d"
"\x2f\xfc\xff\x29\x29\x2e\x29\xaf\x40\x28\xed\xfe\x26\x69\x26\x18\x62\x21\x14\xff\xb2\x00\xfa\x89\x00\xba\x67\x00\xa4\x56\x00\x6a"
"\x3b\x00\x78\x34\x00\xa5\xf3\xfe\xff\x9b\xd8\xff\x7a\xb9\xc4\xbc\xa0\xe5\x98\x98\xff\x8d\x8d\xf1\x82\x82\xe7\xef\x69\x86\x7d\x68"
"\x3c\x58\x5c\x87\x2f\x56\xfb\x50\x50\xfb\xe9\x4a\xe4\x83\x3a\xde\x65\x34\xc2\x4a\x32\xd4\x3a\x2d\xb7\x43\x2a\xe4\xce\x27\xad\xbd"
"\x23\x97\x60\x00\xfb\xe5\xe5\xf7\x79\xb2\xd2\xcb\xaf\xe0\x79\x79\xf2\xf2\x74\xf3\xf2\x71\xac\x1d\x61\x4b\x30\x44\x9e\xa8\x43\x40"
"\x45\x3c\x43\x4b\x35\xe3\xc6\x27\xe8\xde\x26\x9c\x3a\x24\x6c\x0d\x06\xff\xd8\x00\xc6\x84\x00\x06\x59\x6d\x4f\x00\x00\x00\x30\x74"
"\x52\x4e\x53\x00\x17\x05\x12\x34\x0b\x85\xf7\xa9\xe9\x25\x41\x0f\x3b\x2e\x1f\xfb\xd6\xda\xd7\x85\x54\x4a\x49\x3b\xf9\xec\x9d\x5a"
"\xbd\xad\xa9\x92\x7b\x74\x72\xdf\xd7\xcc\xc0\x9d\x9b\x8c\x5c\xd0\xbc\xa6\x64\x72\xea\x32\x94\x00\x00\x06\x31\x49\x44\x41\x54\x58"
"\xc3\xed\x95\x57\x58\x13\x41\x10\x80\x09\x88\xd1\x18\x08\xa8\xd8\x7b\xef\xce\x80\x1a\x93\x08\x24\x20\xa1\x84\x80\x80\x4a\x47\x04"
"\x41\x04\x94\x2a\x82\x88\x02\x02\xa2\x88\xbd\x4b\x07\x05\xec\xbd\xf7\xde\x7b\xef\xbd\xf7\xee\x9b\xbb\x97\x40\x42\x8b\x79\xf0\xd1"
"\xff\xbb\xdb\xdc\x3d\xec\x9f\xd9\xd9\x9d\x39\x9d\xff\xfc\x4b\xf4\x58\xb5\xa0\xaf\xf5\xf4\x16\x0d\x5a\xb1\x6b\xa1\x55\x6b\x9e\x76"
"\xf3\xfb\x43\x5d\x18\xb5\xd0\xd1\xd5\xe2\xff\xa1\x6e\x8c\x38\x5a\x04\xd0\x17\x34\xd0\xf3\xef\x21\xb0\x8c\x00\x20\x22\xc7\xd2\xd2"
"\xd2\xda\x9a\x5e\x96\x74\xa4\x6f\x32\x2a\xe8\xca\xf9\xab\x80\x63\x06\x00\xa6\x58\x0b\x1b\x00\xa0\xa1\xc1\x5f\xf7\x82\xc7\x06\x80"
"\x38\xdc\xff\xe1\xee\xf1\x63\xfb\x8f\x1c\x2b\x38\x42\xc6\xa7\x05\x77\xdf\x7f\x46\x2b\x2a\x68\xa4\x9d\xc0\x12\xb3\xb2\xb2\x9e\xb8"
"\x3d\x7a\xf2\xac\xe0\xb1\x5b\xc1\xe3\x67\x8f\xb2\xb2\x5e\x6a\x2b\xe0\xb4\x64\x04\x67\x4f\x9d\x2d\x16\xbd\x28\x3e\xfe\xad\xf8\xf8"
"\xf7\xe2\x17\xa7\xce\x9e\xd2\x5a\xc0\xec\xa2\x29\x8e\x9e\x3a\x75\xf5\xea\xa9\xa3\x09\x64\x24\xbf\x53\x57\xe3\x00\xed\x04\xcd\xa8"
"\xc0\x1a\x5f\x8d\x08\x18\x51\x79\x05\x04\x04\x8c\xb8\xa2\x14\xe8\x6a\x25\xd8\x81\x65\x43\xaa\xf2\xeb\xb7\x62\x09\xf5\x74\xb4\x14"
"\xd8\x4c\xb3\x21\x4c\x9b\xa6\xbc\x6d\x2e\x5c\x62\x04\x2d\xdb\xb6\x6b\x50\x9d\x76\x4d\x5b\xd4\x10\x58\xe2\xc5\xb2\xcb\xe5\x36\x65"
"\x57\xae\x5e\xb0\xb9\x72\xe9\xc2\xc5\xf2\x8b\x65\x54\x50\x27\xbd\xd4\x04\x86\x40\x18\x80\xe5\xaf\x4a\x31\xe9\x2a\xe2\xe5\xab\x28"
"\xbf\x5c\x8e\x61\x01\x61\x18\x01\x75\xd3\x5a\x75\xc4\xb9\x4d\x14\xdb\x80\x71\x91\x7b\xb7\x47\x38\xe5\xef\x5d\x17\xed\xbd\xd7\x69"
"\x07\x92\x1c\x6a\xa2\x8d\x2a\x84\xa6\x40\x71\xc6\x18\x00\x27\x99\x2c\x26\x5a\x16\xb3\xd2\x0c\x22\x70\x2e\x98\xd5\x81\x3b\x10\xda"
"\xea\x57\x84\xa0\xcb\x61\x42\x58\x89\xa6\xc0\xc6\x93\xf9\x62\x74\xcc\xe7\xc7\x04\x49\x11\xf9\x04\x32\x22\xa1\xe2\x81\x4f\x91\xce"
"\xa5\x6b\x6b\x62\x58\x29\xd0\x35\x31\x62\xd6\xe0\x0c\x91\xc2\xf9\x30\xdd\x35\x10\xee\x3b\x2f\xa5\x73\xea\xc4\x8a\x96\x69\x3d\x7d"
"\x55\x41\xb3\x2b\x05\x6b\x03\xa7\xbb\xda\x05\xce\x72\x8e\xc6\x84\x3b\x21\x21\x21\x9b\x92\x93\xdf\x6d\x4a\x4e\x4d\x0d\xd9\x14\x95"
"\x1c\x72\x2b\x2a\xf9\x56\x48\xc8\xae\x5d\x53\x98\xec\x34\x56\x2b\xd3\x5e\xa0\x14\x04\x09\xc7\x84\x4f\x77\x35\x0f\x9f\x45\x22\x48"
"\xb8\xbd\x3b\x33\xd3\x1d\xa2\x32\xa3\x00\xd6\xec\x06\x23\xd8\xb6\x11\x60\xfd\xc3\xdd\xe9\xe9\x35\x04\xcd\xa0\x42\xe0\x24\x1c\x63"
"\xcb\x08\xc6\x11\x41\xfa\xbe\x03\x07\x36\xae\x7f\xbd\x2b\x15\xdc\xa3\xf6\x41\x14\x6c\xdb\x06\xa9\x77\x0e\xec\xcb\xcc\xac\x21\x68"
"\x02\x14\x19\x49\x3b\x28\x04\xb6\xb3\x76\x5a\x61\x62\xfa\xcc\xbc\xbc\xf5\x6b\xe0\x76\x2a\x18\xad\xc9\x23\x59\x4a\xdf\x08\x79\x0f"
"\x67\x12\x14\x02\xe3\x4a\x01\x07\x08\x41\xa6\xa1\x88\x87\x66\xf0\x5d\xbd\xc5\x52\x47\x6f\x69\xa8\x0f\x86\xf9\xfb\xfb\xaf\x9a\x77"
"\xb8\x70\x55\x42\x61\x61\x21\x79\x48\xf8\x99\x70\xd8\x7f\x95\x3f\x41\xce\x08\xba\x50\x81\x6a\x05\x33\xb0\x3a\x73\x3f\x0d\x1d\x3a"
"\x74\xf8\xa8\xe1\xf4\xa6\x03\xbd\x87\x32\x48\xab\xd5\x79\x3d\x2a\x58\x47\x0d\xfc\x1c\x53\x86\x1c\xd9\xca\xd3\xb8\xe7\xfa\xc0\xda"
"\xb9\x3e\xbc\x9a\x80\xdb\x87\x1a\xd8\x58\x2a\xe7\x07\x41\x05\xd6\xb8\x67\xe0\xe0\x5a\x79\x73\x63\x54\xf5\x4e\xd3\x06\x08\xd1\x78"
"\x3e\x11\x85\xc0\x10\xcd\x97\xe5\xe0\x9e\x1b\x83\x6a\x67\x6c\x0d\x01\xa7\x21\xb3\x09\xe7\x5d\xe4\x98\xab\xa8\x4c\x3c\x14\x87\xf1"
"\x4b\x2c\x2c\xc6\x8e\xb5\xb0\xb0\xd8\xb2\x64\x8b\x05\xf3\x48\x58\x32\xd6\x62\x4b\x4d\x01\x8f\x0a\xac\x30\xcc\xe5\x0c\xe2\x41\x36"
"\x38\x21\x62\x68\x2e\x3e\x58\xe2\xe9\x11\x1f\xef\xb1\xcc\xd3\xf3\xc1\x0a\xcf\x65\x9e\x19\x19\x1e\xcb\x96\x79\xc6\xaf\xf0\xf4\xf4"
"\x18\xa5\xea\xb6\xaa\x7a\x26\xd3\xe4\x6e\x2e\x89\x88\x42\x6b\x29\x4e\x91\x8b\xad\xb1\x64\x85\x47\x1a\x62\x9a\xc7\xa2\x78\x8c\x5f"
"\x94\xb6\xa8\x04\xd3\xd2\x3c\x56\x60\xf6\x22\x8f\x0c\xc4\x48\xd5\x36\x32\xb4\xa3\x5f\x51\x3e\x3e\xf7\xf3\x3d\x13\x86\x88\x53\x7c"
"\xc3\x70\x40\x28\x62\x76\xc9\xd7\x22\xf9\xd1\x6c\xf4\xc1\xa3\x19\xd9\x52\x71\x49\xc6\x47\xf9\x17\x61\xf6\x51\xb2\x40\xa6\x9c\x39"
"\xdc\xaa\x0d\xc1\x07\xcf\xb9\x88\x7c\x67\xff\x48\x4a\x72\x73\x49\x42\xab\x96\xc4\x70\x02\xec\xc7\x9d\x28\xda\x0a\xb1\xa7\x85\x27"
"\x16\x0a\x8a\x84\x73\xbd\xec\x17\x16\x21\xfa\x30\xfd\xa0\x03\x4f\x15\x41\x1b\x45\xea\xe4\x22\x3f\x91\x9b\xaf\x9f\xdf\x6c\xdf\x79"
"\x18\x47\xcf\xd6\x4e\x10\xd8\x4f\x00\x0a\x33\xda\xdb\xdb\x0b\xec\x61\x32\x3a\x01\x4d\x41\x73\x9e\xae\xaa\x9c\x1b\x02\xe1\x34\x26"
"\xb9\xcc\x16\x89\xdc\xdc\x44\xbe\x89\xe8\x03\x10\x83\xe3\x40\x22\x90\xc4\x0e\x1b\x36\xec\x5e\xec\x4e\x3a\x6e\x15\x08\x04\x13\x42"
"\x99\x3d\x30\xab\x6f\xc8\xd2\xa9\xda\xd4\x68\xf6\xcf\xcd\x76\x13\x11\xfc\xce\xa0\x98\x94\x27\x15\x4c\xd8\x8c\xae\xde\x8e\xde\x28"
"\xcd\x77\xf4\x76\xc5\x60\x62\x98\xac\xa8\xc5\xe6\x1c\xf5\x2f\x96\x01\x50\xa2\x91\xa6\x81\xc4\xe0\x27\x42\x64\x53\x81\xbd\x83\x60"
"\xb9\xd8\x36\x30\x10\xbc\xb7\x43\x78\xe0\x7c\xe1\x62\x81\x44\x29\x30\x6e\xc4\x52\xff\x62\xb5\x56\x76\x04\xf9\x73\x17\x5f\x17\x9a"
"\x85\x52\xdc\x40\x5e\x87\x31\x82\xf9\xb6\x76\xe1\x8e\x13\x03\xed\x6c\xd7\x0a\x17\x4b\x24\x12\x65\x04\x06\x5c\xb5\xf9\x2c\x77\x65"
"\x41\xce\x7b\x9a\x98\x38\xef\x7c\x52\x58\x29\xa2\x8c\x0a\x26\x04\x13\xc1\x02\xbb\x91\xb6\x8e\x13\xc3\xe7\xdb\xad\x15\xbe\x95\x38"
"\x50\x81\xb2\x1b\xa8\xe8\x0d\x84\x18\x54\x47\x3a\x80\x11\xa4\x48\x88\x60\xa4\xb9\x9d\xe3\x44\x5b\xf3\x91\x63\x84\x9b\x1d\x82\x1d"
"\xe6\x28\x04\x9c\x1a\x82\x38\xe4\x4b\xc5\xae\x3e\xb9\xce\x2b\x97\x5a\x6d\x88\x64\xd3\x15\x79\x09\x52\x1c\x62\xc5\x0b\xcc\x19\xc1"
"\xf8\x2a\x82\x56\x1d\x99\x14\xa8\x77\x04\xf7\xa0\x08\x33\x50\x87\x0a\x16\x32\x82\xf1\x23\x1d\x27\xda\x8d\x37\x1f\x23\xbc\x19\x9c"
"\x12\x4c\x05\x94\xd6\x6a\x06\x7d\x63\xa8\x09\x15\x48\x16\x07\xc7\x8a\xaf\xa9\x09\x52\x16\xa6\x50\x01\x43\x53\x1d\x95\xa2\x4d\x6d"
"\x02\x19\xb3\x8d\x5b\x4f\x8e\x27\x39\xf0\xde\x4e\x72\x70\x4d\xb9\x8d\x91\xc0\xc0\xe6\x54\x0a\xf4\xb9\x9d\x5a\xa9\x26\xba\x33\x2d"
"\xce\x94\x74\xd9\x39\xe3\x72\xbd\x7c\xa4\xf7\x27\x4d\x9a\x24\x3c\x49\x86\x59\xfc\x83\x5e\x5e\x5e\x42\x3c\x68\x6a\xca\xb4\xae\x4e"
"\x95\x02\x5d\x2e\xcb\xa4\x7d\x37\xe3\x6e\xdd\xdb\xf7\xeb\xd1\xa1\x73\x07\x45\x4a\x35\xe2\xc3\xac\x41\x5f\xdd\xc0\x69\x64\xd2\xdc"
"\xc0\x90\xc0\x31\x51\xb4\x79\x8d\x38\x31\x11\xa8\x1f\x46\x5d\x3d\x16\x8f\xc3\x63\xe9\xe9\xe9\x71\x79\x4d\x40\x2b\x5a\x9a\x50\x81"
"\x9a\x82\xa0\x78\xea\xa8\x9d\xa0\xbd\x7a\x3d\x56\x31\x71\x7b\x82\x16\x74\x27\xf5\x58\x87\x40\x9f\xd7\xd1\xd8\x08\x34\xe2\xde\xb8"
"\x47\x73\x43\xb2\x82\x5a\xa1\xf9\x68\xd4\xb9\xbe\x46\x3a\x9b\x18\xd4\x3d\x9f\xc6\xc0\xe2\x19\xd6\xd3\x84\x21\x87\xc7\xa5\xf3\x35"
"\x28\xb8\x7a\x9a\xe0\x92\x23\xf0\x1f\x05\x7f\x00\xa0\xc5\xc9\x88\xba\x13\x40\x3c\x00\x00\x00\x00\x49\x45\x4e\x44\xae\x42\x60\x82";

typedef struct image_data {
	uint8_t *data;
	int width;
	int height;
}IMAGE_DATA_t;

typedef struct window_user_data {
	IMAGE_DATA_t img001;
}WINDOW_USER_DATA_t;

int static size = 26;

static void redraw(glvWindow glv_win)
{

    glClearColor(1.0, 1.0, 1.0, 1.0);
	glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

	glvFont_SetStyle(GLV_FONT_NAME_NORMAL,size,0.0f,0,GLV_FONT_NAME | GLV_FONT_NOMAL | GLV_FONT_SIZE | GLV_FONT_LEFT);
	glvFont_setColorRGBA(255,  0, 0,255);
	glvFont_SetBkgdColorRGBA(255,255,255,255);
	glvFont_SetPosition(0,0);

	glvFont_printf("%s","ABC");

	struct window_user_data *window_user_data = glv_getUserData(glv_win);

	if(window_user_data->img001.data != NULL){
		glPushMatrix();
		glEnable(GL_BLEND);
		glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

		uint32_t textureID;
		textureID = glvGl_GenTextures(window_user_data->img001.data,window_user_data->img001.width,window_user_data->img001.height);
		if(0 != textureID){
			glvGl_DrawTexturesEx(textureID,
				0.0, 0.0,
				(float)window_user_data->img001.width  * 1.0f,
				(float)window_user_data->img001.height * 1.0f,
				0.0, 0.0,
				0.0);

			// テクスチャ解放
			glvGl_DeleteTextures(&textureID);
		}

		glDisable(GL_BLEND);
		glPopMatrix();
	}

	glvReqSwapBuffers(glv_win);
}

static int window_init(glvWindow glv_win,int width, int height)
{
	glvGl_init();	// openglを使用するための初期化処理
	glvWindow_setViewport(glv_win,width,height);
	glv_allocUserData(glv_win,sizeof(struct window_user_data));
	struct window_user_data *window_user_data = glv_getUserData(glv_win);

#if 1
	window_user_data->img001.data = glv_decodePngDataForMemory(image_c_source,&window_user_data->img001.width,&window_user_data->img001.height);
#else
#define FILE_NAME	"/home/t-aikawa/image-io/a.png"
	window_user_data->img001.data = glv_decodePngDataForFilePath(FILE_NAME,&window_user_data->img001.width,&window_user_data->img001.height);
	glv_createCsourcePngDataForFilePath(FILE_NAME,"image_c_source");
#endif

	return(GLV_OK);
}

static int window_reshape(glvWindow glv_win,int width, int height)
{
	size = (width>height)?(height*0.8):(width*0.4);		// 描画する文字フォントのサイズ

	glvWindow_setViewport(glv_win,width,height);
    redraw(glv_win);
	
	return(GLV_OK);
}


static int window_redraw(glvWindow glv_win,int drawStat)
{
    redraw(glv_win);
	return(GLV_OK);
}

static int window_terminate(glvWindow glv_win)
{
	struct window_user_data *window_user_data = glv_getUserData(glv_win);
	printf("window_terminate\n");

	free(window_user_data->img001.data);

	return(GLV_OK);
}

static const struct glv_window_listener _window_listener = {
	.init			= window_init,
	.reshape		= window_reshape,
	.redraw			= window_redraw,
	.terminate		= window_terminate,
};
const struct glv_window_listener *window_listener = &_window_listener;

glvWindow	main_window = NULL;

int main_frame_start(glvWindow frame_window,int width, int height)
{
	// 描画用のウインドウを作成する
	glvCreateWindow(frame_window,window_listener,&main_window,"window",0, 0, width, height,GLV_WINDOW_ATTR_DEFAULT);
	glvOnReDraw(main_window);	// 	描画要求
	return(GLV_OK);
}

static const struct glv_frame_listener _frame_window_listener = {
	.start	= main_frame_start,		// 	フレーム作成時、最初に呼び出される
};
static const struct glv_frame_listener *frame_window_listener = &_frame_window_listener;

int main(int argc, char *argv[])
{
	glvDisplay	glv_dpy;
	glvWindow	frame_window = NULL;

	glv_dpy = glvOpenDisplay(NULL);
	if(!glv_dpy){
		fprintf(stderr,"Error: glvOpenDisplay() failed\n");
		return(-1);
	}

	// フレームを作成する
	glvCreateFrameWindow(glv_dpy,frame_window_listener,&frame_window,"frame","sample 001",400, 550);

	/* ----------------------------------------------------------------------------------------------- */
	glvEnterEventLoop(glv_dpy);		// event loop
	/* ----------------------------------------------------------------------------------------------- */

	// 	終了処理
	glvDestroyWindow(&main_window);
	glvDestroyWindow(&frame_window);
	glvCloseDisplay(glv_dpy);

	printf("all terminated.\n");

	return(0);
}
